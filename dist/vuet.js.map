{"version":3,"file":"vuet.js","sources":["../src/debug.js","../src/rules/life.js","../src/rules/index.js","../src/utils.js","../src/vuet-static.js","../src/vuet.js","../src/index.js"],"sourcesContent":["\nexport default {\n  error (msg) {\n    throw new Error(`[vuet] ${msg}`)\n  },\n  warn (msg) {\n    if (process.env.NODE_ENV !== 'production') {\n      typeof console !== 'undefined' && console.warn(`[vuet] ${msg}`)\n    }\n  },\n  assertPath (vuet, path) {\n    if (path in vuet.modules) {\n      return\n    }\n    this.error('The module does not exist. Call the this.$vuet method in the Vue component to see all module paths')\n  }\n}\n","import debug from '../debug'\n\nexport default {\n  rule ({ path }) {\n    return {\n      beforeCreate () {\n        debug.assertPath(this.$vuet, path)\n        console.log(this.$vuet)\n      },\n      destroyed () {\n      }\n    }\n  }\n}\n","import life from './life'\n\nexport default function install (Vuet) {\n  Vuet.rule('life', life)\n}\n","const utils = {\n  isObject (obj) {\n    return obj && Object.prototype.toString(obj)\n  },\n  getArgMerge () {\n    let opt = {}\n    const args = arguments\n    if (typeof args[0] === 'string') {\n      opt[args[0]] = args.length > 1 ? args[1] : args[0]\n    } else if (args[0] && utils.isObject(args[0])) {\n      opt = args[0]\n    }\n    return opt\n  }\n}\n\nexport default utils\n","import utils from './utils'\n\nexport default function (Vuet) {\n  Object.assign(Vuet, {\n    installed: false,\n    options: {\n      rules: {}\n    },\n    install (Vue) {\n      if (this.installed) return this\n      this.installed = true\n      this.Vue = Vue\n      Object.defineProperty(Vue.prototype, '$vuet', {\n        get () { return this.$root._vuet }\n      })\n      Vue.mixin({\n        beforeCreate () {\n          if (typeof this.$options.vuet !== 'undefined') {\n            this._vuet = this.$options.vuet\n            // this._vuet._init(this)\n          }\n        },\n        destroyed () {\n          if (typeof this.$options.vuet !== 'undefined') {\n            this._vuet = this.$options.vuet\n            this._vuet.destroy(this)\n          }\n        }\n      })\n      return this\n    },\n    mapModules (opts) {\n      const mixins = Object.keys(opts).map(name => {\n        const path = opts[name]\n        return {\n          computed: {\n            [name]: {\n              get () {\n                return this.$vuet.modules[path].state\n              },\n              set (val) {\n                this.$vuet.modules[path].state = val\n              }\n            },\n            [`$${name}`]: {\n              get () {\n                return this.$vuet.modules[path]\n              },\n              set () { }\n            }\n          }\n        }\n      })\n      return {\n        mixins\n      }\n    },\n    mapRules () {\n      const opts = utils.getArgMerge.apply(null, arguments)\n      const vueRules = []\n      const addRule = (ruleName, any) => {\n        const rules = Vuet.options.rules[ruleName]\n        if (typeof any === 'string') {\n          vueRules.push(rules.rule({ path: any }))\n        } else {\n          vueRules.push(rules.rule(any))\n        }\n      }\n      Object.keys(opts).forEach(ruleName => {\n        const any = opts[ruleName]\n        if (Array.isArray(any)) {\n          return any.forEach(item => {\n            addRule(ruleName, item)\n          })\n        }\n        addRule(ruleName, any)\n      })\n      return {\n        mixins: vueRules\n      }\n    },\n    rule (name, opts) {\n      Vuet.options.rules[name] = opts\n    }\n  })\n}\n","import utils from './utils'\n\nexport default class Vuet {\n  constructor () {\n    this.modules = {}\n    this.app = new Vuet.Vue({\n      data: {\n        modules: this.modules\n      }\n    })\n  }\n  _init () {\n  }\n  register (path, opts) {\n    const vuet = this\n    opts.state = opts.data()\n    Object.assign(opts, {\n      reset () {\n        this.state = this.data()\n      }\n    })\n    Object.keys(opts).forEach(k => {\n      if (typeof opts[k] === 'function') {\n        const native = opts[k]\n        opts[k] = function proxy () {\n          return native.apply(vuet.modules[path], arguments)\n        }\n      }\n    })\n    if (utils.isObject(opts.state)) {\n      Object.keys(opts.state).forEach(k => {\n        Object.defineProperty(opts, k, {\n          get () {\n            return opts.state[k]\n          },\n          set (val) {\n            opts.state[k] = val\n          }\n        })\n      })\n    }\n    Vuet.Vue.set(this.modules, path, opts)\n  }\n  destroy () {\n    this.vm.$destroy()\n  }\n}\n","import rules from './rules/index'\nimport VuetStatic from './vuet-static'\nimport Vuet from './vuet'\n\nVuetStatic(Vuet)\nrules(Vuet)\n\nexport const mapRules = Vuet.mapRules.bind(Vuet)\nexport const mapModules = Vuet.mapModules.bind(Vuet)\n\nexport default Vuet\n"],"names":["msg","Error","process","console","warn","vuet","path","modules","error","assertPath","$vuet","log","install","Vuet","rule","life","utils","obj","Object","prototype","toString","opt","args","arguments","length","isObject","assign","Vue","installed","defineProperty","$root","_vuet","mixin","$options","destroy","opts","mixins","keys","map","name","state","val","getArgMerge","apply","vueRules","addRule","ruleName","any","rules","options","push","forEach","Array","isArray","item","app","data","k","native","proxy","set","vm","$destroy","VuetStatic","mapRules","bind","mapModules"],"mappings":"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"}