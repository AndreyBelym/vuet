!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.Vuet=t.Vuet||{})}(this,function(t){"use strict";var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),r=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},s=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},u={isObject:function(t){return!!t&&"[object Object]"===Object.prototype.toString.call(t)},getArgMerge:function(){var t={},e=arguments;return"string"==typeof e[0]?t[e[0]]=e.length>1?e[1]:e[0]:e[0]&&u.isObject(e[0])&&(t=e[0]),t},isPromise:function(t){return!!t&&("object"===(void 0===t?"undefined":e(t))||"function"==typeof t)&&"function"==typeof t.then}},a=void 0,f={error:function(t){throw new Error("[vuet] "+t)},warn:function(t){},assertModule:function(t,e){e in t.modules||this.error("The '"+e+"' module does not exist")},assertVue:function(){a||this.error("must call Vue.use(Vuet) before creating a store instance")},assertPromise:function(){"undefined"==typeof Promise&&this.error("Vuet requires a Promise polyfill in this browser")}},c={rule:function(t){var e=t.path;return{beforeCreate:function(){f.assertModule(this.$vuet,e),this.$vuet.getModule(e).fetch()},destroyed:function(){this.$vuet.getModule(e).reset()}}}},l={rule:function(t){var e=t.path;return{beforeCreate:function(){f.assertModule(this.$vuet,e),this.$vuet.getModule(e).fetch()}}}},h={init:function(t){t.register("__once__",{data:function(){return[]}})},rule:function(t){var e=t.path;return{beforeCreate:function(){f.assertModule(this.$vuet,e);var t=this.$vuet.getModule("__once__");if(!(t.state.indexOf(e)>-1)){var n=this.$vuet.getModule(e).fetch();if(u.isPromise(n))return n.then(function(n){t.state.push(e)});t.state.push(e)}}}}},p=function(){function t(e){var o=this;n(this,t),f.assertVue(),f.assertPromise(),this.modules={},this.store={},this.options={pathJoin:"/",modules:{}},this.app=null,this.vm=new a({data:{modules:this.store}}),Object.assign(this.options,e);u.isObject(this.options.modules)&&function t(e,n){Object.keys(n).forEach(function(r){var i=n[r],a=[].concat(s(e),[r]),f=a.join(o.options.pathJoin);"function"==typeof i.data&&o.register(f,i),u.isObject(i.modules)&&t(a,i.modules)})}([],this.options.modules),t.callRuleHook("init",this)}return o(t,[{key:"_init",value:function(t){this.app=t}},{key:"register",value:function(t,e){var n=this;return e=i({},e),a.set(n.store,t,e.data()),n.modules[t]=e,n.modules[t].vuet=this,n.modules[t].app=n.app,Object.defineProperty(e,"state",{get:function(){return n.store[t]},set:function(e){n.store[t]=e}}),Object.assign(e,{reset:function(){this.state=this.data()}}),Object.keys(e).forEach(function(o){if("function"==typeof e[o]){var r=e[o];e[o]=function(){return r.apply(n.modules[t],arguments)}}}),u.isObject(e.state)&&Object.keys(e.state).forEach(function(o){if(o in e)return f.warn("'"+o+"' already exists on the object");Object.defineProperty(e,o,{get:function(){return n.store[t][o]},set:function(e){n.store[t][o]=e}})}),this}},{key:"getModule",value:function(t){return f.assertModule(this,t),this.modules[t]}},{key:"getState",value:function(t){return f.assertModule(this,t),this.modules[t].state}},{key:"destroy",value:function(){this.vm.$destroy(),t.callRuleHook("destroy",this)}}]),t}();!function(t){Object.assign(t,{installed:!1,options:{rules:{}},install:function(e){return this.installed?this:(this.installed=!0,a=e,Object.defineProperty(e.prototype,"$vuet",{get:function(){return this.$root._vuet}}),e.mixin({beforeCreate:function(){void 0!==this.$options.vuet&&this.$options.vuet instanceof t&&(this._vuet=this.$options.vuet,this._vuet._init(this))},destroyed:function(){void 0!==this.$options.vuet&&this.$options.vuet instanceof t&&this._vuet.destroy(this)}}),this)},mapModules:function(t){return{mixins:Object.keys(t).map(function(e){var n=t[e];return{computed:r({},e,{get:function(){return f.assertModule(this.$vuet,n),this.$vuet.modules[n]},set:function(t){f.assertModule(this.$vuet,n),this.$vuet.modules[n]=t}})}})}},mapRules:function(){var e=u.getArgMerge.apply(null,arguments),n=[],o=function(e,o){var r=t.options.rules[e];"string"==typeof o?n.push(r.rule({path:o})):n.push(r.rule(o))};return Object.keys(e).forEach(function(t){var n=e[t];if(Array.isArray(n))return n.forEach(function(e){o(t,e)});o(t,n)}),{mixins:n}},rule:function(){return t.options.rules[arguments[0]]=arguments[1],"function"==typeof arguments[1].install&&arguments[1].install(t),this},callRuleHook:function(e,n){Object.keys(t.options.rules).forEach(function(o){"function"==typeof t.options.rules[o][e]&&t.options.rules[o][e](n)})}})}(p),function(t){t.rule("temp",c).rule("need",l).rule("once",h)}(p);var d=p.mapRules.bind(p),y=p.mapModules.bind(p);t.mapRules=d,t.mapModules=y,t.default=p,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=vuet.min.js.map
