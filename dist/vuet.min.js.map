{"version":3,"file":"vuet.min.js","sources":["../src/debug.js","../src/rules/life.js","../src/utils.js","../src/vuet.js","../src/vuet-static.js","../src/index.js","../src/rules/index.js"],"sourcesContent":["\nexport default {\n  error (msg) {\n    throw new Error(`[vuet] ${msg}`)\n  },\n  warn (msg) {\n    if (process.env.NODE_ENV !== 'production') {\n      typeof console !== 'undefined' && console.warn(`[vuet] ${msg}`)\n    }\n  },\n  assertPath (vuet, path) {\n    if (path in vuet.modules) {\n      return\n    }\n    this.error('The module does not exist. Call the this.$vuet method in the Vue component to see all module paths')\n  }\n}\n","import debug from '../debug'\n\nexport default {\n  rule ({ name }) {\n    return {\n      beforeCreate () {\n        debug.assertPath(this.$vuet, name)\n        this.$vuet.signin(name).fetch()\n      },\n      destroyed () {\n        this.$vuet.signin(name).reset()\n      }\n    }\n  }\n}\n","const utils = {\n  isObject (obj) {\n    return obj && Object.prototype.toString(obj)\n  },\n  getArgMerge () {\n    let opt = {}\n    const args = arguments\n    if (typeof args[0] === 'string') {\n      opt[args[0]] = args.length > 1 ? args[1] : args[0]\n    } else if (args[0] && utils.isObject(args[0])) {\n      opt = args[0]\n    }\n    return opt\n  }\n}\n\nexport default utils\n","import utils from './utils'\n\nexport default class Vuet {\n  constructor () {\n    this.modules = {}\n    this.app = new Vuet.Vue({\n      data: {\n        modules: this.modules\n      }\n    })\n  }\n  _init () {\n  }\n  register (name, opts) {\n    const vuet = this\n    opts.state = opts.data()\n    Object.assign(opts, {\n      reset () {\n        this.state = this.data()\n      }\n    })\n    Object.keys(opts).forEach(k => {\n      if (typeof opts[k] === 'function') {\n        const native = opts[k]\n        opts[k] = function proxy () {\n          return native.apply(vuet.modules[name], arguments)\n        }\n      }\n    })\n    if (utils.isObject(opts.state)) {\n      Object.keys(opts.state).forEach(k => {\n        Object.defineProperty(opts, k, {\n          get () {\n            return opts.state[k]\n          },\n          set (val) {\n            opts.state[k] = val\n          }\n        })\n      })\n    }\n    Vuet.Vue.set(this.modules, name, opts)\n  }\n  signin (name) {\n    return this.modules[name]\n  }\n  destroy () {\n    this.vm.$destroy()\n  }\n}\n","import utils from './utils'\n\nexport default function (Vuet) {\n  Object.assign(Vuet, {\n    installed: false,\n    options: {\n      rules: {}\n    },\n    install (Vue) {\n      if (this.installed) return this\n      this.installed = true\n      this.Vue = Vue\n      Object.defineProperty(Vue.prototype, '$vuet', {\n        get () { return this.$root._vuet }\n      })\n      Vue.mixin({\n        beforeCreate () {\n          if (typeof this.$options.vuet !== 'undefined') {\n            this._vuet = this.$options.vuet\n            // this._vuet._init(this)\n          }\n        },\n        destroyed () {\n          if (typeof this.$options.vuet !== 'undefined') {\n            this._vuet = this.$options.vuet\n            this._vuet.destroy(this)\n          }\n        }\n      })\n      return this\n    },\n    mapModules (opts) {\n      const mixins = Object.keys(opts).map(alias => {\n        const name = opts[alias]\n        return {\n          computed: {\n            [alias]: {\n              get () {\n                return this.$vuet.modules[name].state\n              },\n              set (val) {\n                this.$vuet.modules[name].state = val\n              }\n            },\n            [`$${alias}`]: {\n              get () {\n                return this.$vuet.modules[name]\n              },\n              set () { }\n            }\n          }\n        }\n      })\n      return {\n        mixins\n      }\n    },\n    mapRules () {\n      const opts = utils.getArgMerge.apply(null, arguments)\n      const vueRules = []\n      const addRule = (ruleName, any) => {\n        const rules = Vuet.options.rules[ruleName]\n        if (typeof any === 'string') {\n          vueRules.push(rules.rule({ name: any }))\n        } else {\n          vueRules.push(rules.rule(any))\n        }\n      }\n      Object.keys(opts).forEach(ruleName => {\n        const any = opts[ruleName]\n        if (Array.isArray(any)) {\n          return any.forEach(item => {\n            addRule(ruleName, item)\n          })\n        }\n        addRule(ruleName, any)\n      })\n      return {\n        mixins: vueRules\n      }\n    },\n    rule (name, opts) {\n      Vuet.options.rules[name] = opts\n    }\n  })\n}\n","import rules from './rules/index'\nimport VuetStatic from './vuet-static'\nimport Vuet from './vuet'\n\nVuetStatic(Vuet)\nrules(Vuet)\n\nexport const mapRules = Vuet.mapRules.bind(Vuet)\nexport const mapModules = Vuet.mapModules.bind(Vuet)\n\nexport default Vuet\n","import life from './life'\n\nexport default function install (Vuet) {\n  Vuet.rule('life', life)\n}\n"],"names":["msg","Error","vuet","path","modules","error","name","assertPath","this","$vuet","signin","fetch","reset","utils","obj","Object","prototype","toString","opt","args","arguments","length","isObject","Vuet","app","Vue","opts","state","data","assign","keys","forEach","k","native","apply","defineProperty","val","set","vm","$destroy","installed","$root","_vuet","mixin","$options","destroy","map","alias","getArgMerge","vueRules","addRule","ruleName","any","rules","options","push","rule","Array","isArray","item","life","mapRules","bind","mapModules"],"mappings":"8LACA,uBACSA,QACC,IAAIC,iBAAgBD,kBAEtBA,yBAKME,EAAMC,GACZA,IAAQD,GAAKE,cAGZC,MAAM,+HCXLC,KAAAA,sCAGIC,WAAWC,KAAKC,MAAOH,QACxBG,MAAMC,OAAOJ,GAAMK,mCAGnBF,MAAMC,OAAOJ,GAAMM,YCV1BC,qBACMC,SACDA,IAAOC,OAAOC,UAAUC,SAASH,8BAGpCI,MACEC,EAAOC,gBACU,gBAAZD,GAAK,KACVA,EAAK,IAAMA,EAAKE,OAAS,EAAIF,EAAK,GAAKA,EAAK,GACvCA,EAAK,IAAMN,EAAMS,SAASH,EAAK,QAClCA,EAAK,IAEND,idCVUK,yCAEZnB,gBACAoB,IAAM,GAAID,GAAKE,mBAEPjB,KAAKJ,uFAMVE,EAAMoB,MACRxB,GAAOM,OACRmB,MAAQD,EAAKE,cACXC,OAAOH,yBAELC,MAAQnB,KAAKoB,iBAGfE,KAAKJ,GAAMK,QAAQ,eACD,kBAAZL,GAAKM,GAAmB,IAC3BC,GAASP,EAAKM,KACfA,GAAK,iBACDC,GAAOC,MAAMhC,EAAKE,QAAQE,GAAOc,eAI1CP,EAAMS,SAASI,EAAKC,eACfG,KAAKJ,EAAKC,OAAOI,QAAQ,mBACvBI,eAAeT,EAAMM,wBAEjBN,GAAKC,MAAMK,iBAEfI,KACET,MAAMK,GAAKI,SAKnBX,IAAIY,IAAI7B,KAAKJ,QAASE,EAAMoB,kCAE3BpB,SACCE,MAAKJ,QAAQE,0CAGfgC,GAAGC,qBC7CG,SAAUhB,UAChBM,OAAON,cACD,sCAIFE,SACHjB,MAAKgC,UAAkBhC,WACtBgC,WAAY,OACZf,IAAMA,SACJU,eAAeV,EAAIT,UAAW,8BACnBR,MAAKiC,MAAMC,WAEzBC,mCAEkC,KAAvBnC,KAAKoC,SAAS1C,YAClBwC,MAAQlC,KAAKoC,SAAS1C,gCAKK,KAAvBM,KAAKoC,SAAS1C,YAClBwC,MAAQlC,KAAKoC,SAAS1C,UACtBwC,MAAMG,QAAQrC,UAIlBA,2BAEGkB,iBACKX,OAAOe,KAAKJ,GAAMoB,IAAI,kBAC7BxC,EAAOoB,EAAKqB,6BAGbA,wBAEUvC,MAAKC,MAAML,QAAQE,GAAMqB,oBAE7BS,QACE3B,MAAML,QAAQE,GAAMqB,MAAQS,aAGhCW,wBAEMvC,MAAKC,MAAML,QAAQE,sDAY9BoB,GAAOb,EAAMmC,YAAYd,MAAM,KAAMd,WACrC6B,KACAC,EAAU,SAACC,EAAUC,MACnBC,GAAQ9B,EAAK+B,QAAQD,MAAMF,EACd,iBAARC,KACAG,KAAKF,EAAMG,MAAOlD,KAAM8C,OAExBG,KAAKF,EAAMG,KAAKJ,mBAGtBtB,KAAKJ,GAAMK,QAAQ,eAClBqB,GAAM1B,EAAKyB,MACbM,MAAMC,QAAQN,SACTA,GAAIrB,QAAQ,cACToB,EAAUQ,OAGdR,EAAUC,aAGVH,kBAGN3C,EAAMoB,KACL4B,QAAQD,MAAM/C,GAAQoB,MC9EtBH,GCFI,SAAkBA,KAC1BiC,KAAK,OAAQI,IDEdrC,EAEN,IAAasC,GAAWtC,EAAKsC,SAASC,KAAKvC,GAC9BwC,EAAaxC,EAAKwC,WAAWD,KAAKvC"}